apiVersion: v1
kind: Secret
metadata:
  name: rhacs-alertmanager-configuration
  namespace: {{ include "observability.namespace" . }}
stringData:
  alertmanager.yml: |
    global:
      resolve_timeout: 5m
    route:
      receiver: default-receiver
      repeat_interval: 12h
      routes:
      - receiver: managed-rhacs-pagerduty
        match:
          observability: managed-rhacs
          severity: critical
      - receiver: managed-rhacs-deadmanssnitch
        repeat_interval: 5m
        match:
          alertname: DeadMansSwitch
          observability: managed-rhacs
    receivers:
    - name: default-receiver
    - name: managed-rhacs-pagerduty
      pagerduty_configs:
      - service_key: {{ .Values.pagerduty.key | quote }}
    - name: managed-rhacs-deadmanssnitch
      webhook_configs:
      - url: {{ .Values.deadMansSwitch.url | quote }}
type: Opaque
