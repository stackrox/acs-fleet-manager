apiVersion: v1
kind: Secret
metadata:
  name: rhacs-alertmanager-configuration
  namespace: {{ include "observability.namespace" . }}
stringData:
  alertmanager.yaml: |
    global:
      resolve_timeout: 5m
    route:
      receiver: managed-rhacs-pagerduty
      repeat_interval: 12h
      routes:
      - receiver: managed-rhacs-deadmanssnitch
        repeat_interval: 5m
        match:
          alertname: DeadMansSwitch
          observability: managed-rhacs
    receivers:
    - name: managed-rhacs-pagerduty
      pagerduty_configs:
      - routing_key: {{ .Values.pagerduty.key | quote }}
        severity: "{{ "{{" }} or .GroupLabels.severity \"info\" }}"
    - name: managed-rhacs-deadmanssnitch
      webhook_configs:
      - url: {{ .Values.deadMansSwitch.url | quote }}
type: Opaque
